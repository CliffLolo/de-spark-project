{
  "paragraphs": [
    {
      "text": "%spark.pyspark\nfrom pyspark import SparkContext\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql.functions import lit\nfrom pyspark.sql.functions import to_date\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType, DoubleType\nimport datetime\nimport os\n\n# Create a SparkContext and a SparkSession\nsc = SparkContext.getOrCreate()\nspark = SparkSession(sc)\n\n# Set the base directory where the batch folders are located\nbase_dir = \"/Users/cliffordfrempong/Downloads/tpcds_data_5g_batch_and_streaming/tpcds_data_5g_batch\"\n\n# Set the schema for the time_dim table\ntime_dim_schema = StructType([\n  StructField(\"t_time_sk\",IntegerType(), True),\n  StructField(\"t_time_id\",  StringType(), True),\n  StructField(\"t_time\", IntegerType(), True),\n  StructField(\"t_hour\", IntegerType(), True),\n  StructField(\"t_minute\", IntegerType(), True),\n  StructField(\"t_second\", IntegerType(), True),\n  StructField(\"t_am_pm\", StringType(), True),\n  StructField(\"t_shift\", StringType(), True),\n  StructField(\"t_sub_shift\", StringType(), True),\n  StructField(\"t_meal_time\", StringType(), True)\n])\n\n# Set the schema for the customer table\ncustomer_schema = StructType([\n  StructField(\"c_customer_sk\",IntegerType(), True),\n  StructField(\"c_customer_id\",  StringType(), True),\n  StructField(\"c_current_cdemo_sk\", IntegerType(), True),\n  StructField(\"c_current_hdemo_sk\", IntegerType(), True),\n  StructField(\"c_current_addr_sk\", IntegerType(), True),\n  StructField(\"c_first_shipto_date_sk\", IntegerType(), True),\n  StructField(\"c_first_sales_date_sk\", IntegerType(), True),\n  StructField(\"c_salutation\", StringType(), True),\n  StructField(\"c_first_name\", StringType(), True),\n  StructField(\"c_last_name\", StringType(), True),\n  StructField(\"c_preferred_cust_flag\", StringType(), True),\n  StructField(\"c_birth_day\", IntegerType(), True),\n  StructField(\"c_birth_month\", IntegerType(), True),\n  StructField(\"c_birth_year\", IntegerType(), True),\n  StructField(\"c_birth_country\", StringType(), True),\n  StructField(\"c_login\", StringType(), True),\n  StructField(\"c_email_address\", StringType(), True),\n  StructField(\"c_last_review_date\", StringType(), True)\n])\n\n# Set the schema for the customer_address table\ncustomer_address_schema = StructType([\n  StructField(\"ca_address_sk\",IntegerType(), True),\n  StructField(\"ca_address_id\",  StringType(), True),\n  StructField(\"ca_street_number\", StringType(), True),\n  StructField(\"ca_street_name\", StringType(), True),\n  StructField(\"ca_street_type\", StringType(), True),\n  StructField(\"ca_suite_number\", StringType(), True),\n  StructField(\"ca_city\", StringType(), True),\n  StructField(\"ca_county\", StringType(), True),\n  StructField(\"ca_state\", StringType(), True),\n  StructField(\"ca_zip\", StringType(), True),\n  StructField(\"ca_country\", StringType(), True),\n  StructField(\"ca_gmt_offset\", DoubleType(), True),\n  StructField(\"ca_location_type\", StringType(), True)\n])\n\n# Set the schema for the customer_demographics table\ncustomer_demographics_schema = StructType([\n  StructField(\"cd_demo_sk\",IntegerType(), True),\n  StructField(\"cd_gender\",  StringType(), True),\n  StructField(\"cd_marital_status\", StringType(), True),\n  StructField(\"cd_education_status\", StringType(), True),\n  StructField(\"cd_purchase_estimate\", IntegerType(), True),\n  StructField(\"cd_credit_rating\", StringType(), True),\n  StructField(\"cd_dep_count\", IntegerType(), True),\n  StructField(\"cd_dep_employed_count\", IntegerType(), True),\n  StructField(\"cd_dep_college_count\", IntegerType(), True)\n])\n\n# Set the schema for the date_dim table\ndate_dim_schema = StructType([\n  StructField(\"d_date_sk\",IntegerType(), True),\n  StructField(\"d_date_id\",  StringType(), True),\n  StructField(\"d_date\", StringType(), True),\n  StructField(\"d_month_seq\", IntegerType(), True),\n  StructField(\"d_week_seq\", IntegerType(), True),\n  StructField(\"d_quarter_seq\", IntegerType(), True),\n  StructField(\"d_year\", IntegerType(), True),\n  StructField(\"d_dow\", IntegerType(), True),\n  StructField(\"d_moy\", IntegerType(), True),\n  StructField(\"d_dom\", IntegerType(), True),\n  StructField(\"d_qoy\", IntegerType(), True),\n  StructField(\"d_fy_year\", IntegerType(), True),\n  StructField(\"d_fy_quarter_seq\", IntegerType(), True),\n  StructField(\"d_fy_week_seq\", IntegerType(), True),\n  StructField(\"d_day_name\", StringType(), True),\n  StructField(\"d_quarter_name\", StringType(), True),\n  StructField(\"d_holiday\", StringType(), True),\n  StructField(\"d_weekend\", StringType(), True),\n  StructField(\"d_following_holiday\", StringType(), True),\n  StructField(\"d_first_dom\", IntegerType(), True),\n  StructField(\"d_last_dom\", IntegerType(), True),\n  StructField(\"d_same_day_ly\", IntegerType(), True),\n  StructField(\"d_same_day_lq\", IntegerType(), True),\n  StructField(\"d_current_day\", StringType(), True),\n  StructField(\"d_current_week\", StringType(), True),\n  StructField(\"d_current_month\", StringType(), True),\n  StructField(\"d_current_quarter\", StringType(), True),\n  StructField(\"d_current_year\", StringType(), True)\n])\n\n# Set the schema for the household_demographics table\nhousehold_demographics_schema = StructType([\n  StructField(\"hd_demo_sk\",IntegerType(), True),\n  StructField(\"hd_income_band_sk\",  IntegerType(), True),\n  StructField(\"hd_buy_potential\", StringType(), True),\n  StructField(\"hd_dep_count\", IntegerType(), True),\n  StructField(\"hd_vehicle_count\", IntegerType(), True)\n])\n\n# Set the schema for the income_band table\nincome_band_schema = StructType([\n  StructField(\"ib_income_band_sk\",IntegerType(), True),\n  StructField(\"ib_lower_bound\",  IntegerType(), True),\n  StructField(\"ib_upper_bound\", IntegerType(), True)\n])\n\n# Set the schema for the item table\nitem_schema = StructType([\n  StructField(\"i_item_sk\",IntegerType(), True),\n  StructField(\"i_item_id\",  StringType(), True),\n  StructField(\"i_rec_start_date\", StringType(), True),\n  StructField(\"i_rec_end_date\", StringType(), True),\n  StructField(\"i_item_desc\", StringType(), True),\n  StructField(\"i_current_price\", DoubleType(), True),\n  StructField(\"i_wholesale_cost\", DoubleType(), True),\n  StructField(\"i_brand_id\", IntegerType(), True),\n  StructField(\"i_brand\", StringType(), True),\n  StructField(\"i_class_id\", IntegerType(), True),\n  StructField(\"i_class\", StringType(), True),\n  StructField(\"i_category_id\", IntegerType(), True),\n  StructField(\"i_category\", StringType(), True),\n  StructField(\"i_manufact_id\", IntegerType(), True),\n  StructField(\"i_manufact\", StringType(), True),\n  StructField(\"i_size\", StringType(), True),\n  StructField(\"i_formulation\", StringType(), True),\n  StructField(\"i_color\", StringType(), True),\n  StructField(\"i_units\", StringType(), True),\n  StructField(\"i_container\", StringType(), True),\n  StructField(\"i_manager_id\", IntegerType(), True),\n  StructField(\"i_product_name\", StringType(), True)\n])\n\n# Set the schema for the promotion table\npromotion_schema = StructType([\n  StructField(\"p_promo_sk\",IntegerType(), True),\n  StructField(\"p_promo_id\",  StringType(), True),\n  StructField(\"p_start_date_sk\", IntegerType(), True),\n  StructField(\"p_end_date_sk\", IntegerType(), True),\n  StructField(\"p_item_sk\", IntegerType(), True),\n  StructField(\"p_cost\", DoubleType(), True),\n  StructField(\"p_response_target\", IntegerType(), True),\n  StructField(\"p_promo_name\", StringType(), True),\n  StructField(\"p_channel_dmail\", StringType(), True),\n  StructField(\"p_channel_email\", StringType(), True),\n  StructField(\"p_channel_catalog\", StringType(), True),\n  StructField(\"p_channel_tv\", StringType(), True),\n  StructField(\"p_channel_radio\", StringType(), True),\n  StructField(\"p_channel_press\", StringType(), True),\n  StructField(\"p_channel_event\", StringType(), True),\n  StructField(\"p_channel_demo\", StringType(), True),\n  StructField(\"p_channel_details\", StringType(), True),\n  StructField(\"p_purpose\", StringType(), True),\n  StructField(\"p_discount_active\", StringType(), True)\n])\n\n# Set the schema for the store table\nstore_schema = StructType([\n  StructField(\"s_store_sk\",IntegerType(), True),\n  StructField(\"s_store_id\",  StringType(), True),\n  StructField(\"s_rec_start_date\", StringType(), True),\n  StructField(\"s_rec_end_date\", StringType(), True),\n  StructField(\"s_closed_date_sk\", IntegerType(), True),\n  StructField(\"s_store_name\", StringType(), True),\n  StructField(\"s_number_employees\", IntegerType(), True),\n  StructField(\"s_floor_space\", IntegerType(), True),\n  StructField(\"s_hours\", StringType(), True),\n  StructField(\"s_manager\", StringType(), True),\n  StructField(\"s_market_id\", IntegerType(), True),\n  StructField(\"s_geography_class\", StringType(), True),\n  StructField(\"s_market_desc\", StringType(), True),\n  StructField(\"s_market_manager\", StringType(), True),\n  StructField(\"s_division_id\", IntegerType(), True),\n  StructField(\"s_division_name\", StringType(), True),\n  StructField(\"s_company_id\", IntegerType(), True),\n  StructField(\"s_company_name\", StringType(), True),\n  StructField(\"s_street_number\", StringType(), True),\n  StructField(\"s_street_name\", StringType(), True),\n  StructField(\"s_street_type\", StringType(), True),\n  StructField(\"s_suite_number\", StringType(), True),\n  StructField(\"s_city\", StringType(), True),\n  StructField(\"s_county\", StringType(), True),\n  StructField(\"s_state\", StringType(), True),\n  StructField(\"s_zip\", StringType(), True),\n  StructField(\"s_country\", StringType(), True),\n  StructField(\"s_gmt_offset\", DoubleType(), True),\n  StructField(\"s_tax_precentage\", DoubleType(), True)\n])\n\n# Set the schema for the store_sales table\nstore_sales_schema = StructType([\n  StructField(\"ss_sold_date_sk\",IntegerType(), True),\n  StructField(\"ss_sold_time_sk\", IntegerType(), True),\n  StructField(\"ss_item_sk\", IntegerType(), True),\n  StructField(\"ss_customer_sk\", IntegerType(), True),\n  StructField(\"ss_cdemo_sk\", IntegerType(), True),\n  StructField(\"ss_hdemo_sk\", IntegerType(), True),\n  StructField(\"ss_addr_sk\", IntegerType(), True),\n  StructField(\"ss_store_sk\", IntegerType(), True),\n  StructField(\"ss_promo_sk\", IntegerType(), True),\n  StructField(\"ss_ticket_number\", IntegerType(), True),\n  StructField(\"ss_quantity\", IntegerType(), True),\n  StructField(\"ss_wholesale_cost\", DoubleType(), True),\n  StructField(\"ss_list_price\", DoubleType(), True),\n  StructField(\"ss_sales_price\", DoubleType(), True),\n  StructField(\"ss_ext_discount_amt\", DoubleType(), True),\n  StructField(\"ss_ext_sales_price\", DoubleType(), True),\n  StructField(\"ss_ext_wholesale_cost\", DoubleType(), True),\n  StructField(\"ss_ext_list_price\", DoubleType(), True),\n  StructField(\"ss_ext_tax\", DoubleType(), True),\n  StructField(\"ss_coupon_amt\", DoubleType(), True),\n  StructField(\"ss_net_paid\", DoubleType(), True),\n  StructField(\"ss_net_paid_inc_tax\", DoubleType(), True),\n  StructField(\"ss_net_profit\", DoubleType(), True)\n])\n\n\n# Set the schema mapping for each table\nschema_mapping = {\n    \"time_dim\": time_dim_schema,\n    \"customer\": customer_schema,\n    \"customer_address\": customer_address_schema,\n    # \"customer_demographics\": customer_demographics_schema,\n    \"date_dim\": date_dim_schema,\n    \"household_demographics\": household_demographics_schema,\n    # \"income_band\": income_band_schema,\n    \"item\": item_schema,\n    \"promotion\": promotion_schema,\n    \"store\": store_schema,\n    \"store_sales\": store_sales_schema\n}\n\n# Set the table names\ntable_names = [\"time_dim\",\"customer\",\"customer_address\", \"date_dim\", \"household_demographics\", \"item\", \"promotion\", \"store\", \"store_sales\"]\n\n# print(schema_mapping[\"customer\"])\n\n# Set the delimiter for the CSV files\ndelimiter = \"|\"\n\n# Set the base path for the CSV files\ncsv_base_path = \"{}/{{}}/{{}}\".format(base_dir)\n\n# Set the base path for the batch dirs\nbatch_base_path = \"{}/{{}}\".format(base_dir)\n\n# Iterate through the batch folders\n# for batch_folder in [\"batch_1999-01-01\", \"batch_1999-04-01\", \"batch_2000-01-01\"]:\n\n# Using os.listdir() to get a list of all the files and directories in the specified directory\ncontents = os.listdir(base_dir)\n\n# Iterate over the contents of the directory\nfor batch_folder in contents:\n    # Check if the item is a directory and its name starts with \"batch_\"\n    if os.path.isdir(os.path.join(base_dir, batch_folder)) and batch_folder.startswith(\"batch_\"):\n        # If the item is a batch folder, print its name\n        print(\"*********************************************\") \n        print(f\"Currently working in {batch_folder}\")\n        print(\"*********************************************\")  \n        \n        for table_name in table_names:\n            \n            # Check the name of the table\n            if table_name == \"store_sales\":\n                write_mode = \"append\"\n            else:\n                # Set the write mode to \"error\" if the table is not recognized\n                write_mode = \"overwrite\"\n    \n            # Construct the path to the CSV file\n            csv_path = csv_base_path.format(batch_folder, table_name )\n\n           # Iterate through all the files in the directory\n            for filename in os.listdir(csv_path):\n                \n          # Check if the file is a CSV file\n                if filename.endswith('.csv'):\n\n                    # Get the schema for the table\n                    schema = schema_mapping[table_name]\n                    \n                    # Read the CSV file into a dataframe\n                    df = spark.read.csv(os.path.join(csv_path, filename),header=\"false\", schema=schema,  sep='|')\n                    # Construct the path to the CSV file\n                    batch_path = batch_base_path.format(batch_folder)\n                    \n                    # Extract the date from the batch folder name\n                    date = batch_path.split(\"_\")[-1]\n\n                    # Add the date as a new column to the DataFrame\n                    df = df.withColumn('batch_date', to_date(lit(date), 'yyyy-MM-dd'))\n\n                    print(f\"Inserting into {table_name}\")\n                    # Set the JDBC connection properties\n                    jdbc_url = \"jdbc:postgresql://localhost:5432/bigspark\"\n                    df.write.jdbc(jdbc_url, table_name, mode=write_mode)\n                    print(f\"Insertion into {table_name} Complete\")\n                    \nprint(\"*********************************************\")                         \nprint(\"All Insertions Complete!\")\nprint(\"*********************************************\") \n",
      "user": "anonymous",
      "dateUpdated": "2023-01-09T15:57:05+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=50",
              "$$hashKey": "object:55720"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=50",
              "$$hashKey": "object:55721"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=51",
              "$$hashKey": "object:55722"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=51",
              "$$hashKey": "object:55723"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=52",
              "$$hashKey": "object:55724"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=52",
              "$$hashKey": "object:55725"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=53",
              "$$hashKey": "object:55726"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=53",
              "$$hashKey": "object:55727"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=54",
              "$$hashKey": "object:55728"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=54",
              "$$hashKey": "object:55729"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=55",
              "$$hashKey": "object:55730"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=55",
              "$$hashKey": "object:55731"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=56",
              "$$hashKey": "object:55732"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=56",
              "$$hashKey": "object:55733"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=57",
              "$$hashKey": "object:55734"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=57",
              "$$hashKey": "object:55735"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=58",
              "$$hashKey": "object:55736"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=58",
              "$$hashKey": "object:55737"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=59",
              "$$hashKey": "object:55738"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=59",
              "$$hashKey": "object:55739"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=60",
              "$$hashKey": "object:55740"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=60",
              "$$hashKey": "object:55741"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=61",
              "$$hashKey": "object:55742"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=61",
              "$$hashKey": "object:55743"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=62",
              "$$hashKey": "object:55744"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=62",
              "$$hashKey": "object:55745"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=63",
              "$$hashKey": "object:55746"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=63",
              "$$hashKey": "object:55747"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=64",
              "$$hashKey": "object:55748"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=64",
              "$$hashKey": "object:55749"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=65",
              "$$hashKey": "object:55750"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=65",
              "$$hashKey": "object:55751"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=66",
              "$$hashKey": "object:55752"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=66",
              "$$hashKey": "object:55753"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=67",
              "$$hashKey": "object:55754"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=67",
              "$$hashKey": "object:55755"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=68",
              "$$hashKey": "object:55756"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=68",
              "$$hashKey": "object:55757"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=69",
              "$$hashKey": "object:55758"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=69",
              "$$hashKey": "object:55759"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=70",
              "$$hashKey": "object:55760"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=70",
              "$$hashKey": "object:55761"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=71",
              "$$hashKey": "object:55762"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=71",
              "$$hashKey": "object:55763"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=72",
              "$$hashKey": "object:55764"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=72",
              "$$hashKey": "object:55765"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=73",
              "$$hashKey": "object:55766"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=73",
              "$$hashKey": "object:55767"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=74",
              "$$hashKey": "object:55768"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=74",
              "$$hashKey": "object:55769"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=75",
              "$$hashKey": "object:55770"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=75",
              "$$hashKey": "object:55771"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=76",
              "$$hashKey": "object:55772"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=76",
              "$$hashKey": "object:55773"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=77",
              "$$hashKey": "object:55774"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=77",
              "$$hashKey": "object:55775"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=78",
              "$$hashKey": "object:55776"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=78",
              "$$hashKey": "object:55777"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=79",
              "$$hashKey": "object:55778"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=79",
              "$$hashKey": "object:55779"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=80",
              "$$hashKey": "object:55780"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=80",
              "$$hashKey": "object:55781"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=81",
              "$$hashKey": "object:55782"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=81",
              "$$hashKey": "object:55783"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=82",
              "$$hashKey": "object:55784"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=82",
              "$$hashKey": "object:55785"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=83",
              "$$hashKey": "object:55786"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=83",
              "$$hashKey": "object:55787"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=84",
              "$$hashKey": "object:55788"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=84",
              "$$hashKey": "object:55789"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=85",
              "$$hashKey": "object:55790"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=85",
              "$$hashKey": "object:55791"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=86",
              "$$hashKey": "object:55792"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=86",
              "$$hashKey": "object:55793"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=87",
              "$$hashKey": "object:55794"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=87",
              "$$hashKey": "object:55795"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=88",
              "$$hashKey": "object:55796"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=88",
              "$$hashKey": "object:55797"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=89",
              "$$hashKey": "object:55798"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=89",
              "$$hashKey": "object:55799"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=90",
              "$$hashKey": "object:55800"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=90",
              "$$hashKey": "object:55801"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=91",
              "$$hashKey": "object:55802"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=91",
              "$$hashKey": "object:55803"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=92",
              "$$hashKey": "object:55804"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=92",
              "$$hashKey": "object:55805"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=93",
              "$$hashKey": "object:55806"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=93",
              "$$hashKey": "object:55807"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=94",
              "$$hashKey": "object:55808"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=94",
              "$$hashKey": "object:55809"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=95",
              "$$hashKey": "object:55810"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=95",
              "$$hashKey": "object:55811"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=96",
              "$$hashKey": "object:55812"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=96",
              "$$hashKey": "object:55813"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=97",
              "$$hashKey": "object:55814"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=97",
              "$$hashKey": "object:55815"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=98",
              "$$hashKey": "object:55816"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=98",
              "$$hashKey": "object:55817"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=99",
              "$$hashKey": "object:55818"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=99",
              "$$hashKey": "object:55819"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=100",
              "$$hashKey": "object:55820"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=100",
              "$$hashKey": "object:55821"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=101",
              "$$hashKey": "object:55822"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=101",
              "$$hashKey": "object:55823"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=102",
              "$$hashKey": "object:55824"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=102",
              "$$hashKey": "object:55825"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=103",
              "$$hashKey": "object:55826"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=103",
              "$$hashKey": "object:55827"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=104",
              "$$hashKey": "object:55828"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=104",
              "$$hashKey": "object:55829"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=105",
              "$$hashKey": "object:55830"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=105",
              "$$hashKey": "object:55831"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=106",
              "$$hashKey": "object:55832"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=106",
              "$$hashKey": "object:55833"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=107",
              "$$hashKey": "object:55834"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=107",
              "$$hashKey": "object:55835"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=108",
              "$$hashKey": "object:55836"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=108",
              "$$hashKey": "object:55837"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=109",
              "$$hashKey": "object:55838"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=109",
              "$$hashKey": "object:55839"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=110",
              "$$hashKey": "object:55840"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=110",
              "$$hashKey": "object:55841"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=111",
              "$$hashKey": "object:55842"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=111",
              "$$hashKey": "object:55843"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=112",
              "$$hashKey": "object:55844"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=112",
              "$$hashKey": "object:55845"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=113",
              "$$hashKey": "object:55846"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=113",
              "$$hashKey": "object:55847"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=114",
              "$$hashKey": "object:55848"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=114",
              "$$hashKey": "object:55849"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=115",
              "$$hashKey": "object:55850"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=115",
              "$$hashKey": "object:55851"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=116",
              "$$hashKey": "object:55852"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=116",
              "$$hashKey": "object:55853"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=117",
              "$$hashKey": "object:55854"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=117",
              "$$hashKey": "object:55855"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=118",
              "$$hashKey": "object:55856"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=118",
              "$$hashKey": "object:55857"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=119",
              "$$hashKey": "object:55858"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=119",
              "$$hashKey": "object:55859"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=120",
              "$$hashKey": "object:55860"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=120",
              "$$hashKey": "object:55861"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=121",
              "$$hashKey": "object:55862"
            },
            {
              "jobUrl": "http://192.168.100.8:4043/jobs/job?id=121",
              "$$hashKey": "object:55863"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1671924563426_1055797304",
      "id": "paragraph_1671924563426_1055797304",
      "dateCreated": "2022-12-24T23:29:23+0000",
      "dateStarted": "2023-01-09T15:54:06+0000",
      "dateFinished": "2023-01-09T15:54:54+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:183",
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "*********************************************\nCurrently working in batch_1998-07-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nCurrently working in batch_1999-07-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nCurrently working in batch_2000-01-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nCurrently working in batch_1999-01-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nCurrently working in batch_1999-10-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nCurrently working in batch_1999-04-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nCurrently working in batch_1998-04-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nCurrently working in batch_1998-10-01\n*********************************************\nInserting into time_dim\noverwrite\nInsertion into time_dim Complete\nInserting into customer\noverwrite\nInsertion into customer Complete\nInserting into customer_address\noverwrite\nInsertion into customer_address Complete\nInserting into date_dim\noverwrite\nInsertion into date_dim Complete\nInserting into household_demographics\noverwrite\nInsertion into household_demographics Complete\nInserting into item\noverwrite\nInsertion into item Complete\nInserting into promotion\noverwrite\nInsertion into promotion Complete\nInserting into store\noverwrite\nInsertion into store Complete\nInserting into store_sales\nappend\nInsertion into store_sales Complete\n*********************************************\nAll Insertions Complete!\n*********************************************\n"
          }
        ]
      }
    },
    {
      "text": "%spark.pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2023-01-09T15:51:04+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1673279464816_710763093",
      "id": "paragraph_1673279464816_710763093",
      "dateCreated": "2023-01-09T15:51:04+0000",
      "status": "READY",
      "focus": true,
      "$$hashKey": "object:612"
    }
  ],
  "name": "batch_ETL",
  "id": "2HPHEYWRG",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "inIsolatedMode": false,
    "startTime": "2023-01-01_13-03-07"
  },
  "path": "/batch_ETL"
}